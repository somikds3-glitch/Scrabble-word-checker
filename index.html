<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Somik’s Scrabble Word Panel</title>
<style>
  :root { --bg:#0f1226; --card:#181b3a; --ink:#eef0ff; --muted:#9aa0ff; --ok:#34c38f; --no:#ff6b6b; --line:#2a2f63; }
  * { box-sizing: border-box }
  body { margin:0; font-family: ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial; background: radial-gradient(1200px 700px at 70% -10%, #1a2050, #0f1226); color:var(--ink); }
  .wrap { max-width:720px; margin:7vh auto; padding:0 16px; }
  .card { background:var(--card); border:1px solid var(--line); border-radius:16px; padding:24px; box-shadow:0 10px 30px rgba(0,0,0,.35) }
  h1 { margin:0 0 6px; font-size:clamp(24px,4vw,34px); letter-spacing:.3px }
  .sub { margin:0 0 18px; color:#c6caff }
  form { display:flex; gap:10px; flex-wrap:wrap }
  input { flex:1 1 320px; padding:14px 16px; border-radius:12px; border:1px solid var(--line); background:#0f1230; color:var(--ink); font-size:16px; outline:none }
  input::placeholder { color:#8b90d6 }
  button { padding:14px 18px; border-radius:12px; border:1px solid var(--line); background:#2a2f63; color:var(--ink); font-weight:600; cursor:pointer }
  .grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:14px }
  .panel { border:1px dashed var(--line); border-radius:12px; padding:14px; min-height:92px; position:relative; overflow:hidden }
  .tag { position:absolute; top:8px; right:10px; font-size:12px; color:var(--muted) }
  .status { font-size:18px; margin-top:2px }
  .ok { color:var(--ok) } .no { color:var(--no) }
  .blink { animation: blink .9s ease-in-out 2 }
  @keyframes blink { 50% { opacity:.35 } }
  .shake { animation: s .3s linear 2 } @keyframes s { 25%{transform:translateX(3px)} 75%{transform:translateX(-3px)} }
  .mini { color:var(--muted); font-size:12px; margin-top:10px }
  .footer { margin-top:14px; color:#b7bcff; font-size:12px }
  .links { margin-top:6px; display:flex; gap:10px; flex-wrap:wrap }
  a { color:#cfd3ff }
  canvas { position:fixed; inset:0; pointer-events:none; }
</style>
</head>
<body>
<canvas id="fx"></canvas>

<div class="wrap">
  <div class="card">
    <h1>Somik’s Scrabble Word Panel</h1>
    <p class="sub">Type a word. I’ll check <b>NWL</b> and <b>CSW</b> live—no wordlist uploads.</p>

    <form id="form">
      <input id="word" type="text" placeholder="e.g., gapy, tod" maxlength="15" autocomplete="off" required />
      <button type="submit">Check</button>
    </form>

    <div class="grid">
      <div class="panel" id="nwlBox">
        <div class="tag">NWL (US/Canada)</div>
        <div class="status" id="nwlStatus">Waiting…</div>
        <div class="mini" id="nwlNote"></div>
      </div>
      <div class="panel" id="cswBox">
        <div class="tag">CSW (Collins, Intl)</div>
        <div class="status" id="cswStatus">Waiting…</div>
        <div class="mini" id="cswNote"></div>
      </div>
    </div>

    <div class="footer">
      Heads-up: Official lists are licensed. This tool pings the public Merriam (NWL) and Collins (CSW) checkers through a read-only mirror to avoid CORS. Treat results as indicative, not gospel. If something looks off, open the source links below and double-check.
      <div class="links" id="links"></div>
    </div>
  </div>
</div>

<script>
const wordEl = document.getElementById('word');
const formEl = document.getElementById('form');
const nwlStatus = document.getElementById('nwlStatus');
const cswStatus = document.getElementById('cswStatus');
const nwlNote = document.getElementById('nwlNote');
const cswNote = document.getElementById('cswNote');
const links = document.getElementById('links');
const fx = document.getElementById('fx');
const ctx = fx.getContext('2d');

function fitCanvas(){ fx.width = innerWidth; fx.height = innerHeight }
addEventListener('resize', fitCanvas); fitCanvas();

function confettiBurst() {
  const parts = Array.from({length: 120}, () => ({
    x: innerWidth/2, y: innerHeight/5,
    vx: (Math.random()-0.5)*6, vy: (Math.random()*-4)-2,
    g: .13 + Math.random()*0.05,
    r: 2 + Math.random()*3,
    life: 60 + Math.random()*40
  }));
  let t = 0;
  (function anim(){
    ctx.clearRect(0,0,fx.width,fx.height);
    parts.forEach(p=>{
      p.vy += p.g; p.x += p.vx; p.y += p.vy; p.life--;
      ctx.globalAlpha = Math.max(0, p.life/100);
      ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill();
    });
    t++; if (parts.some(p=>p.life>0)) requestAnimationFrame(anim); else ctx.clearRect(0,0,fx.width,fx.height);
  })();
}

function sanitize(s){
  const v = (s||"").trim();
  if(!/^[a-zA-Z]+$/.test(v)) return null;
  return v.toLowerCase();
}

function makeLink(href, label){
  const a = document.createElement('a');
  a.href = href; a.target = "_blank"; a.rel = "noopener noreferrer";
  a.textContent = label;
  return a;
}

async function fetchText(url){
  const mirror = `https://r.jina.ai/http://${url.replace(/^https?:\/\//,'')}`;
  const res = await fetch(mirror, { cache: 'no-store' });
  if(!res.ok) throw new Error(`Fetch failed: ${res.status}`);
  return await res.text();
}

function parseNWL(text, w){
  const good = new RegExp(`\\b${w}\\b`, 'i').test(text) && /scrabble/i.test(text) && !/no results/i.test(text);
  const bad = /no results/i.test(text) || /not a playable word/i.test(text);
  return good ? 'ok' : (bad ? 'no' : 'maybe');
}
function parseCSW(text, w){
  if (/is a valid scrabble word/i.test(text)) return 'ok';
  if (/is not a valid scrabble word/i.test(text)) return 'no';
  const weakOk = new RegExp(`\\b${w}\\b`, 'i').test(text) && /scrabble/i.test(text);
  return weakOk ? 'ok' : 'maybe';
}

async function checkWord(word){
  const w = sanitize(word);
  links.innerHTML = '';
  [nwlStatus, cswStatus].forEach(el => { el.textContent = 'Checking…'; el.className='status blink' });
  [nwlNote, cswNote].forEach(el => el.textContent = '');

  if(!w){
    [nwlStatus, cswStatus].forEach(el => { el.textContent = 'Letters A–Z only.'; el.className='status no shake' });
    return;
  }

  const srcNWL = `https://scrabble.merriam.com/finder/${w}`;
  const srcCSW = `https://www.collinsdictionary.com/scrabble/scrabble-word-checker/${w}`;

  links.appendChild(makeLink(srcNWL, `Open NWL source for "${w}"`));
  links.appendChild(makeLink(srcCSW, `Open CSW source for "${w}"`));

  try {
    const [nwlText, cswText] = await Promise.all([
      fetchText(srcNWL),
      fetchText(srcCSW)
    ]);

    const n = parseNWL(nwlText, w);
    const c = parseCSW(cswText, w);

    renderStatus(n, nwlStatus, nwlNote, 'NWL');
    renderStatus(c, cswStatus, cswNote, 'CSW');

    if (n === 'ok' || c === 'ok') confettiBurst();

  } catch (e){
    nwlStatus.textContent = 'Could not reach sources.'; nwlStatus.className='status no shake';
    cswStatus.textContent = 'Try again in a bit.'; cswStatus.className='status no';
    nwlNote.textContent = e.message;
  }
}

function renderStatus(state, el, noteEl, tag){
  if (state === 'ok'){ el.textContent = 'Playable ✓'; el.className='status ok'; noteEl.textContent = `${tag}: High confidence`; }
  else if (state === 'no'){ el.textContent = 'Not allowed ✕'; el.className='status no'; noteEl.textContent = `${tag}: High confidence`; }
  else { el.textContent = 'Unclear — check source'; el.className='status'; noteEl.textContent = `${tag}: Low confidence`; }
}

formEl.addEventListener('submit', (e)=>{
  e.preventDefault();
  checkWord(wordEl.value);
});
wordEl.addEventListener('keydown', (e)=>{ if(e.key==='Enter') formEl.requestSubmit(); });
wordEl.focus();
</script>
</body>
</html>